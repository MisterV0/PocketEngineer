<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Median Calculator</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
  <script>
    tailwind.config = {
      theme: {
        extend: {
          fontFamily: {
            sans: ['Plus Jakarta Sans', '-apple-system', 'BlinkMacSystemFont', 'sans-serif'],
            mono: ['JetBrains Mono', 'Menlo', 'monospace'],
          },
          animation: {
            'slide-in': 'slideIn 0.3s cubic-bezier(0.16, 1, 0.3, 1) forwards',
            'fade-in': 'fadeIn 0.3s ease-out forwards',
            'pulse-soft': 'pulseSoft 2s ease-in-out infinite',
            'highlight': 'highlight 0.5s ease-out forwards',
          },
          keyframes: {
            slideIn: {
              '0%': { opacity: '0', transform: 'translateY(10px) scale(0.95)' },
              '100%': { opacity: '1', transform: 'translateY(0) scale(1)' }
            },
            fadeIn: {
              '0%': { opacity: '0' },
              '100%': { opacity: '1' }
            },
            pulseSoft: {
              '0%, 100%': { opacity: '1' },
              '50%': { opacity: '0.7' }
            },
            highlight: {
              '0%': { transform: 'scale(1)', boxShadow: '0 2px 4px rgba(0,0,0,0.1)' },
              '50%': { transform: 'scale(1.1)', boxShadow: '0 8px 16px rgba(59, 130, 246, 0.4)' },
              '100%': { transform: 'scale(1.05)', boxShadow: '0 4px 12px rgba(59, 130, 246, 0.3)' }
            }
          }
        }
      }
    }
  </script>
  <style>
    body { background-color: #fafafa; }
    
    /* Back Button Styling */
    .back-button { 
      display: inline-flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.5rem 0.875rem;
      border-radius: 0.5rem;
      font-size: 0.75rem;
      font-weight: 600;
      color: #71717a;
      border: 1px solid #e4e4e7;
      background-color: white;
      transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1);
      text-decoration: none;
      cursor: pointer;
      box-shadow: 0 1px 2px rgba(0,0,0,0.05);
      letter-spacing: 0.5px;
      position: relative;
      overflow: hidden;
    }
    .back-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
      transition: left 0.5s ease;
    }
    .back-button:hover {
      color: #18181b;
      border-color: #71717a;
      background-color: #ffffff;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      transform: translateY(-2px);
    }
    .back-button:hover::before {
      left: 100%;
    }
    .back-button:hover svg {
      transform: translateX(-2px);
    }
    .back-button:active { 
      transform: scale(0.96);
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    .back-button svg {
      transition: transform 0.2s ease;
    }

    /* Array Element Styling */
    .array-element {
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      animation: slide-in;
      animation-delay: calc(var(--index) * 0.05s);
    }
    
    .array-element:hover {
      transform: translateY(-1px) scale(1.02);
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
    }

    .array-element.median-highlight {
      background: linear-gradient(135deg, #3b82f6 0%, #2563eb 100%);
      border-color: #2563eb;
      color: white;
      box-shadow: 0 4px 12px rgba(59, 130, 246, 0.3);
      animation: highlight 0.5s ease-out forwards;
      z-index: 10;
    }

    .array-element.median-highlight span {
      color: white;
      font-weight: 700;
    }

    /* Add Button - Apple Style Squared */
    .add-button {
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
      border-radius: 0.75rem;
    }
    .add-button:hover {
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    }
    .add-button:active {
      transform: scale(0.95);
    }
    .add-button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
      transform: none;
    }

    /* Generate Button */
    .generate-button {
      transition: all 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    }
    .generate-button:hover:not(:disabled) {
      transform: translateY(-2px);
      box-shadow: 0 8px 16px rgba(0,0,0,0.15);
    }
    .generate-button:active:not(:disabled) {
      transform: translateY(0);
    }
    .generate-button:disabled {
      opacity: 0.4;
      cursor: not-allowed;
    }

    /* Input Field */
    input[type=number]::-webkit-inner-spin-button,
    input[type=number]::-webkit-outer-spin-button {
      -webkit-appearance: none;
      appearance: none;
      margin: 0;
    }
    input[type=number] {
      -moz-appearance: textfield;
      appearance: textfield;
    }

    /* Remove Button Animation */
    .remove-btn {
      transition: all 0.2s ease;
      opacity: 0;
    }
    .array-element:hover .remove-btn {
      opacity: 1;
    }

    /* Result Card */
    .result-card {
      animation: fade-in 0.5s ease-out forwards;
    }

    /* Code Box Styling */
    .code-box {
      background: #1e1e1e;
      border-radius: 0.75rem;
      font-family: 'JetBrains Mono', monospace;
      position: relative;
      overflow: hidden;
      border: 1px solid rgba(255,255,255,0.05);
    }
    .code-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 2rem;
      background: linear-gradient(to bottom, rgba(255,255,255,0.03), transparent);
      pointer-events: none;
    }

    /* Copy Button */
    .copy-button {
      transition: all 0.2s ease;
    }
    .copy-button:hover {
      background-color: rgba(255,255,255,0.1);
    }
    .copy-button:active {
      transform: scale(0.95);
    }

    /* Language Toggle */
    .language-tab {
      color: #a1a1aa;
      background: transparent;
    }
    .language-tab.active {
      color: #ffffff;
      background: #3f3f46;
    }
    .language-tab:hover:not(.active) {
      color: #d4d4d8;
    }

    /* Refined spacing and typography */
    body {
      letter-spacing: -0.01em;
    }

  </style>
</head>
<body class="text-zinc-900 antialiased min-h-screen flex flex-col">

  <!-- Header -->
  <header class="flex-none bg-white/80 backdrop-blur-sm border-b border-zinc-200/50 z-50 relative sticky top-0">
    <div class="max-w-5xl mx-auto px-6 h-16 flex items-center justify-between">
      <a href="index.html" class="back-button">
        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M15 18l-6-6 6-6"/></svg>
        Back
      </a>
      <h1 class="text-lg font-semibold text-zinc-900 tracking-tight">Median Calculator</h1>
      <div class="w-20"></div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="flex-1 flex flex-col items-center px-6 py-8 max-w-5xl mx-auto w-full">
    
    <!-- Input Section -->
    <div class="w-full max-w-2xl mx-auto mb-8">
      <div class="bg-white rounded-xl border border-zinc-200/60 p-5 shadow-sm">
        <div class="flex flex-col md:flex-row md:items-center gap-2.5 mb-3">
          <input 
            type="number" 
            id="number-input" 
            placeholder="Enter a number"
            class="flex-1 px-3.5 py-2.5 rounded-lg border border-zinc-200 focus:border-zinc-900 focus:outline-none focus:ring-2 focus:ring-zinc-900/10 transition-all font-mono text-sm"
            onkeypress="if(event.key === 'Enter') addNumber()"
          >
          <div class="flex items-center gap-2.5 w-full md:w-auto">
            <button 
              id="add-button"
              onclick="addNumber()"
              class="add-button w-11 h-11 bg-zinc-900 text-white flex items-center justify-center font-semibold disabled:opacity-40 disabled:cursor-not-allowed"
            >
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
              </svg>
            </button>
            <button 
              id="random-button"
              onclick="generateRandomNumbers()"
              class="flex-1 md:flex-none px-3.5 py-2.5 rounded-lg border border-zinc-200 bg-white text-zinc-700 hover:bg-zinc-50 hover:border-zinc-300 transition-all text-xs font-semibold whitespace-nowrap"
              title="Generate random numbers"
            >
              Random
            </button>
            <button 
              id="reset-button"
              onclick="resetAll()"
              class="flex-1 md:flex-none px-3.5 py-2.5 rounded-lg border border-zinc-200 bg-white text-zinc-700 hover:bg-zinc-50 hover:border-zinc-300 transition-all text-xs font-semibold whitespace-nowrap"
              title="Clear all numbers"
            >
              Reset
            </button>
          </div>
        </div>
        <p class="text-[10px] text-zinc-400 text-center font-medium">Add 1-30 numbers, then calculate the median</p>
      </div>
    </div>

    <!-- Array Display -->
    <div class="w-full max-w-4xl mx-auto mb-6">
      <div id="array-container" class="flex flex-col gap-2.5 justify-center min-h-[60px] items-center">
        <div class="text-zinc-400 text-xs font-medium animate-pulse-soft">Add numbers to see them here...</div>
      </div>
      
      <!-- New Meta Indicator Container (Text + Legend) -->
      <div id="array-meta-container" class="flex flex-wrap items-center justify-center gap-x-6 gap-y-2 mt-4" style="display: none;">
        <span class="text-xs text-zinc-500 font-medium">Array sorted for median calculation</span>
        
        <!-- Moved Legend -->
        <div class="flex items-center gap-4 text-xs border-l border-zinc-200 pl-6">
          <div class="flex items-center gap-1.5">
            <div class="w-3 h-3 rounded bg-blue-500"></div>
            <span class="text-zinc-600 font-medium">Median value(s)</span>
          </div>
          <div class="flex items-center gap-1.5">
            <div class="w-3 h-3 rounded bg-white border border-zinc-200"></div>
            <span class="text-zinc-500">Other values</span>
          </div>
        </div>
      </div>
    </div>

    <!-- Calculate Button -->
    <div class="w-full max-w-4xl mx-auto mb-6 flex justify-center">
      <button 
        id="calculate-button"
        onclick="calculateMedian()"
        class="generate-button bg-zinc-900 text-white px-7 py-2.5 rounded-lg font-semibold text-xs tracking-wide disabled:opacity-40 disabled:cursor-not-allowed shadow-md"
        disabled
      >
        Calculate Median
      </button>
    </div>

    <!-- Result Display -->
    <div id="result-container" class="w-full max-w-4xl mx-auto" style="display: none;">
      <div class="result-card bg-white rounded-xl border border-zinc-200/60 p-6 shadow-sm">
        <!-- Header Removed as requested -->
        
        <div class="mb-4">
          <div class="flex flex-col gap-1 mb-2">
            <span class="text-4xl font-bold font-mono text-zinc-900 tracking-tight" id="median-value">-</span>
            <!-- Short text removed, replaced by the full explanation below -->
          </div>
          <p class="text-sm text-zinc-600 leading-relaxed font-medium" id="median-explanation">-</p>
        </div>

        <div class="pt-4 border-t border-zinc-100">
          <!-- Legend Removed from here -->
          <div class="flex justify-center pt-2">
            <button 
              id="show-code-button"
              onclick="toggleCodeView()"
              class="px-4 py-2 rounded-lg border border-zinc-200 bg-white text-zinc-700 hover:bg-zinc-50 hover:border-zinc-300 transition-all text-xs font-semibold"
            >
              Need the code?
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Code Output -->
    <div id="code-container" class="w-full max-w-4xl mx-auto" style="display: none;">
      <div class="code-box p-5 text-zinc-100">
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-3">
            <div class="flex items-center gap-1.5">
              <div class="w-2.5 h-2.5 rounded-full bg-red-500"></div>
              <div class="w-2.5 h-2.5 rounded-full bg-yellow-500"></div>
              <div class="w-2.5 h-2.5 rounded-full bg-green-500"></div>
            </div>
            <!-- Language Toggle -->
            <div class="flex items-center gap-1 bg-zinc-800/60 rounded-md p-0.5">
              <button 
                id="lang-c"
                onclick="switchLanguage('c')"
                class="px-2.5 py-1 rounded text-[10px] font-medium transition-all language-tab active"
              >
                C
              </button>
              <button 
                id="lang-python"
                onclick="switchLanguage('python')"
                class="px-2.5 py-1 rounded text-[10px] font-medium transition-all language-tab"
              >
                Python
              </button>
            </div>
            <span id="filename" class="text-[10px] text-zinc-500 font-mono">median.c</span>
          </div>
          <button 
            id="copy-button"
            onclick="copyCode()"
            class="copy-button px-3 py-1.5 rounded-md text-[10px] font-medium text-zinc-300 hover:text-white border border-zinc-700 hover:border-zinc-600 flex items-center gap-1.5"
            style="display: none;"
          >
            <svg width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
              <path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path>
            </svg>
            Copy
          </button>
        </div>
        <pre id="code-output" class="text-xs leading-relaxed overflow-x-auto"><code class="text-zinc-300">// Calculate median to see the code implementation</code></pre>
      </div>
    </div>

  </main>

  <script>
    let numbers = [];
    let sortedNumbers = [];
    let medianSortedIndices = [];
    let isSortedView = false;
    let currentLanguage = 'c';
    let generatedCode = { c: '', python: '' };
    const MAX_ELEMENTS = 30;
    const MIN_ELEMENTS = 1;

    const numberInput = document.getElementById('number-input');
    const addButton = document.getElementById('add-button');
    const arrayContainer = document.getElementById('array-container');
    const calculateButton = document.getElementById('calculate-button');
    const resultContainer = document.getElementById('result-container');
    const codeContainer = document.getElementById('code-container');
    const codeOutput = document.getElementById('code-output');
    const copyButton = document.getElementById('copy-button');
    const arrayMetaContainer = document.getElementById('array-meta-container');

    function addNumber() {
      const value = numberInput.value.trim();
      
      if (value === '') return;
      
      const num = parseFloat(value);
      if (isNaN(num)) {
        numberInput.value = '';
        return;
      }

      if (numbers.length >= MAX_ELEMENTS) {
        // Visual feedback for max reached
        addButton.style.transform = 'scale(0.9)';
        setTimeout(() => {
          addButton.style.transform = '';
        }, 200);
        return;
      }

      numbers.push(num);
      numberInput.value = '';
      numberInput.focus();
      
      // Reset median calculation
      medianSortedIndices = [];
      isSortedView = false;
      resultContainer.style.display = 'none';
      codeContainer.style.display = 'none';
      arrayMetaContainer.style.display = 'none';
      generatedCode = { c: '', python: '' };
      
      updateArrayDisplay();
      updateCalculateButton();
      updateAddButton();
    }

    function removeNumber(originalIndex) {
      // Remove from original array by index
      numbers.splice(originalIndex, 1);
      
      // Reset sorted view and median calculation
      medianSortedIndices = [];
      isSortedView = false;
      sortedNumbers = [];
      resultContainer.style.display = 'none';
      codeContainer.style.display = 'none';
      arrayMetaContainer.style.display = 'none';
      generatedCode = { c: '', python: '' };
      
      updateArrayDisplay();
      updateCalculateButton();
      updateAddButton();
    }

    function removeNumberByValue(value) {
      // Find and remove the first occurrence of this value
      // This ensures we remove the correct element even if there are duplicates
      const index = numbers.indexOf(value);
      if (index !== -1) {
        numbers.splice(index, 1);
      }
      
      // Reset sorted view and median calculation
      medianSortedIndices = [];
      isSortedView = false;
      sortedNumbers = [];
      resultContainer.style.display = 'none';
      codeContainer.style.display = 'none';
      arrayMetaContainer.style.display = 'none';
      generatedCode = { c: '', python: '' };
      
      updateArrayDisplay();
      updateCalculateButton();
      updateAddButton();
    }

    function updateArrayDisplay() {
      if (numbers.length === 0) {
        arrayContainer.innerHTML = '<div class="text-zinc-400 text-xs font-medium animate-pulse-soft">Add numbers to see them here...</div>';
        return;
      }

      // Use sorted view if median was calculated, otherwise show original order
      let displayArray;
      if (isSortedView && sortedNumbers.length > 0) {
        displayArray = sortedNumbers;
      } else {
        displayArray = numbers.map((num, index) => ({ num, originalIndex: index }));
      }

      // Organize numbers into rows of 10
      const rows = [];
      for (let i = 0; i < displayArray.length; i += 10) {
        rows.push(displayArray.slice(i, i + 10));
      }

      arrayContainer.innerHTML = rows.map((row, rowIndex) => {
        return `
          <div class="flex flex-wrap gap-2.5 justify-center">
            ${row.map((item, colIndex) => {
              const displayIndex = rowIndex * 10 + colIndex;
              const delay = displayIndex * 0.03;
              const isMedian = isSortedView && medianSortedIndices.includes(displayIndex);
              const highlightClass = isMedian ? 'median-highlight' : '';
              
              const removeFunction = isSortedView 
                ? `removeNumberByValue(${item.num})` 
                : `removeNumber(${item.originalIndex})`;
              
              return `
                <div 
                  class="array-element bg-white border border-zinc-200/60 rounded-lg px-4 py-2.5 flex items-center gap-2 shadow-sm relative group ${highlightClass}"
                  style="--index: ${displayIndex}; animation-delay: ${delay}s;"
                >
                  <span class="text-sm font-mono font-semibold text-zinc-900">${item.num}</span>
                  <button 
                    onclick="${removeFunction}"
                    class="remove-btn absolute -top-1.5 -right-1.5 w-5 h-5 bg-red-500 text-white rounded-full flex items-center justify-center text-[10px] font-bold hover:bg-red-600 transition-all shadow-md"
                    title="Remove"
                  >
                    <svg width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3">
                      <line x1="18" y1="6" x2="6" y2="18"></line>
                      <line x1="6" y1="6" x2="18" y2="18"></line>
                    </svg>
                  </button>
                </div>
              `;
            }).join('')}
          </div>
        `;
      }).join('');
    }

    function calculateMedian() {
      if (numbers.length === 0) {
        return;
      }

      // Create sorted array with original indices
      sortedNumbers = numbers.map((num, index) => ({ num, originalIndex: index }))
        .sort((a, b) => a.num - b.num);
      
      const sorted = sortedNumbers.map(item => item.num);
      const n = sorted.length;
      let median;
      let medianValues = [];
      let isEven = n % 2 === 0;

      if (isEven) {
        // Even number of elements: median is average of two middle values
        const midIndex1 = n / 2 - 1;
        const midIndex2 = n / 2;
        const mid1 = sorted[midIndex1];
        const mid2 = sorted[midIndex2];
        median = (mid1 + mid2) / 2;
        medianValues = [mid1, mid2];
        // Store the sorted indices (positions in sorted array)
        medianSortedIndices = [midIndex1, midIndex2];
      } else {
        // Odd number of elements: median is the middle value
        const midIndex = Math.floor(n / 2);
        median = sorted[midIndex];
        medianValues = [median];
        // Store the sorted index (position in sorted array)
        medianSortedIndices = [midIndex];
      }

      // Switch to sorted view
      isSortedView = true;
      
      // Update display with highlighting
      updateArrayDisplay();
      
      // Show the meta container (Sorted text + Legend)
      arrayMetaContainer.style.display = 'flex';

      // Display result
      const medianValueEl = document.getElementById('median-value');
      const explanationEl = document.getElementById('median-explanation');

      medianValueEl.textContent = median.toFixed(median % 1 !== 0 ? 2 : 0);
      
      if (isEven) {
        explanationEl.textContent = `With an even number of elements (${n}), the median is the average of the two middle values: ${medianValues[0]} and ${medianValues[1]}. Median = (${medianValues[0]} + ${medianValues[1]}) รท 2 = ${median.toFixed(median % 1 !== 0 ? 2 : 0)}`;
      } else {
        explanationEl.textContent = `With an odd number of elements (${n}), the median is the middle value when sorted.`;
      }

      resultContainer.style.display = 'block';
      
      // Generate code for median calculation (use original numbers array)
      generateCode(numbers, sorted, n, median, isEven, medianValues);
      
      // Smooth scroll to result
      setTimeout(() => {
        resultContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
      }, 100);
    }

    function generateCode(originalNumbers, sorted, n, median, isEven, medianValues) {
      const arrayString = originalNumbers.join(', ');
      const medianFormatted = median % 1 !== 0 ? median.toFixed(2) : median.toFixed(0);
      
      // Generate C code
      if (isEven) {
        const mid1 = medianValues[0];
        const mid2 = medianValues[1];
        const mid1Formatted = mid1 % 1 !== 0 ? mid1.toFixed(2) : mid1.toFixed(0);
        const mid2Formatted = mid2 % 1 !== 0 ? mid2.toFixed(2) : mid2.toFixed(0);
        
        generatedCode.c = `#include <stdio.h>

int main() {
    // 1. Initialize an array
    double arr[${n}] = {${arrayString}};
    int n = ${n};
    
    // 2. Sort the array (using bubble sort for simplicity)
    for (int i = 0; i < n - 1; i++) {
        for (int j = 0; j < n - 1 - i; j++) {
            if (arr[j] > arr[j + 1]) {
                double temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
        }
    }
    
    // 3. Calculate median (even number of elements)
    // For even arrays, median is the average of two middle values
    double median;
    int midIndex1 = n / 2 - 1;
    int midIndex2 = n / 2;
    median = (arr[midIndex1] + arr[midIndex2]) / 2.0;
    
    // 4. Print the result
    printf("Sorted array: \\n");
    for (int i = 0; i < n; i++) {
        printf("%.2f ", arr[i]);
    }
    printf("\\n\\n");
    printf("Median: %.2f\\n", median);
    printf("(Average of middle two values: %.2f and %.2f)\\n", arr[midIndex1], arr[midIndex2]);
    
    return 0;
}`;
      } else {
        const midIndex = Math.floor(n / 2);
        
        generatedCode.c = `#include <stdio.h>

int main() {
    // 1. Initialize an array
    double arr[${n}] = {${arrayString}};
    int n = ${n};
    
    // 2. Sort the array (using bubble sort for simplicity)
    for (int i = 0; i < n - 1; i++) {
        for (int j = 0; j < n - 1 - i; j++) {
            if (arr[j] > arr[j + 1]) {
                double temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
        }
    }
    
    // 3. Calculate median (odd number of elements)
    // For odd arrays, median is the middle value
    int midIndex = n / 2;
    double median = arr[midIndex];
    
    // 4. Print the result
    printf("Sorted array: \\n");
    for (int i = 0; i < n; i++) {
        printf("%.2f ", arr[i]);
    }
    printf("\\n\\n");
    printf("Median: %.2f\\n", median);
    
    return 0;
}`;
      }

      // Generate Python code
      if (isEven) {
        const mid1 = medianValues[0];
        const mid2 = medianValues[1];
        
        generatedCode.python = `# 1. Initialize the list
arr = [${arrayString}]

# 2. Sort the array
# Python's sorted() function creates a new sorted list
sorted_arr = sorted(arr)

# 3. Calculate median (even number of elements)
# For even arrays, median is the average of two middle values
n = len(sorted_arr)
mid_index1 = n // 2 - 1
mid_index2 = n // 2
median = (sorted_arr[mid_index1] + sorted_arr[mid_index2]) / 2.0

# 4. Print the result
print("Sorted array:")
print(sorted_arr)
print()
print(f"Median: {median:.2f}")
print(f"(Average of middle two values: {sorted_arr[mid_index1]} and {sorted_arr[mid_index2]})")`;
      } else {
        const midIndex = Math.floor(n / 2);
        
        generatedCode.python = `# 1. Initialize the list
arr = [${arrayString}]

# 2. Sort the array
# Python's sorted() function creates a new sorted list
sorted_arr = sorted(arr)

# 3. Calculate median (odd number of elements)
# For odd arrays, median is the middle value
n = len(sorted_arr)
mid_index = n // 2
median = sorted_arr[mid_index]

# 4. Print the result
print("Sorted array:")
print(sorted_arr)
print()
print(f"Median: {median:.2f}")`;
      }
    }

    function toggleCodeView() {
      if (generatedCode.c === '' && generatedCode.python === '') {
        return; // No code generated yet
      }
      
      const isVisible = codeContainer.style.display !== 'none';
      if (isVisible) {
        codeContainer.style.display = 'none';
      } else {
        codeContainer.style.display = 'block';
        displayCode();
        copyButton.style.display = 'flex';
        // Smooth scroll to code
        setTimeout(() => {
          codeContainer.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }, 100);
      }
    }

    function switchLanguage(lang) {
      currentLanguage = lang;
      
      // Update active tab
      document.getElementById('lang-c').classList.toggle('active', lang === 'c');
      document.getElementById('lang-python').classList.toggle('active', lang === 'python');
      
      // Update filename
      const filename = document.getElementById('filename');
      filename.textContent = lang === 'c' ? 'median.c' : 'median.py';
      
      // Display the code
      displayCode();
    }

    function highlightComments(code, language) {
      const escaped = escapeHtml(code);
      
      if (language === 'c') {
        // Highlight C comments: // and /* */
        return escaped
          .replace(/(\/\/[^\n]*)/g, '<span class="text-green-400">$1</span>')
          .replace(/(\/\*[\s\S]*?\*\/)/g, '<span class="text-green-400">$1</span>');
      } else if (language === 'python') {
        // Highlight Python comments: #
        return escaped
          .replace(/(#[^\n]*)/g, '<span class="text-green-400">$1</span>');
      }
      
      return escaped;
    }

    function displayCode() {
      if (generatedCode[currentLanguage]) {
        const highlighted = highlightComments(generatedCode[currentLanguage], currentLanguage);
        codeOutput.innerHTML = `<code class="text-zinc-100">${highlighted}</code>`;
      } else {
        codeOutput.innerHTML = '<code class="text-zinc-300">// Calculate median to see the code implementation</code>';
      }
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    async function copyCode() {
      const code = generatedCode[currentLanguage] || codeOutput.textContent;
      if (!code || code.includes('Calculate median')) return;
      
      try {
        await navigator.clipboard.writeText(code);
        
        // Visual feedback
        const originalText = copyButton.innerHTML;
        copyButton.innerHTML = `
          <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <polyline points="20 6 9 17 4 12"></polyline>
          </svg>
          Copied!
        `;
        copyButton.style.borderColor = '#22c55e';
        copyButton.style.color = '#22c55e';
        
        setTimeout(() => {
          copyButton.innerHTML = originalText;
          copyButton.style.borderColor = '';
          copyButton.style.color = '';
        }, 2000);
      } catch (err) {
        console.error('Failed to copy:', err);
      }
    }

    function updateCalculateButton() {
      if (numbers.length >= MIN_ELEMENTS) {
        calculateButton.disabled = false;
      } else {
        calculateButton.disabled = true;
      }
    }

    function generateRandomNumbers() {
      // Generate random count between 5 and 30
      const count = Math.floor(Math.random() * (MAX_ELEMENTS - 4)) + 5;
      
      // Clear existing numbers
      numbers = [];
      sortedNumbers = [];
      medianSortedIndices = [];
      isSortedView = false;
      resultContainer.style.display = 'none';
      codeContainer.style.display = 'none';
      arrayMetaContainer.style.display = 'none';
      generatedCode = { c: '', python: '' };
      
      // Generate random numbers between 1 and 100
      for (let i = 0; i < count; i++) {
        numbers.push(Math.floor(Math.random() * 100) + 1);
      }
      
      updateArrayDisplay();
      updateCalculateButton();
      updateAddButton();
    }

    function resetAll() {
      // Clear all data
      numbers = [];
      sortedNumbers = [];
      medianSortedIndices = [];
      isSortedView = false;
      numberInput.value = '';
      resultContainer.style.display = 'none';
      codeContainer.style.display = 'none';
      arrayMetaContainer.style.display = 'none';
      generatedCode = { c: '', python: '' };
      
      updateArrayDisplay();
      updateCalculateButton();
      updateAddButton();
      numberInput.focus();
    }

    function updateAddButton() {
      if (numbers.length >= MAX_ELEMENTS) {
        addButton.disabled = true;
        addButton.title = `Maximum ${MAX_ELEMENTS} elements reached`;
      } else {
        addButton.disabled = false;
        addButton.title = '';
      }
    }

    // Make functions globally available
    window.addNumber = addNumber;
    window.removeNumber = removeNumber;
    window.removeNumberByValue = removeNumberByValue;
    window.calculateMedian = calculateMedian;
    window.generateRandomNumbers = generateRandomNumbers;
    window.resetAll = resetAll;
    window.toggleCodeView = toggleCodeView;
    window.switchLanguage = switchLanguage;
    window.copyCode = copyCode;

    // Handle Enter key
    numberInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') {
        addNumber();
      }
    });
  </script>

</body>
</html>